#  `pyETRC`列车运行图系统发行说明
## 概要

本软件是“六方车迷会谈” 马兴越 开发的列车运行图软件，主要支持列车运行图的绘制、查看，以及铺画新列车运行图的功能。本软件主要在`Windows10`, `Python3.7.4` + `PyQt5.10.1`环境下开发、调试。本文件是对一般用户发布的简要说明和更新日志文档。关于更多的开发者信息，请移步github开源库中的`README.md`文档。
作者联系方式：mxy0268@qq.com
欢迎加入本系统官方交流群（系统最新的更新渠道，答疑、讨论、反馈平台）：865211882.
本项目开源地址：https://github.com/CDK6182CHR/train_graph

郑重声明：

1. 本软件纯属兴趣开发，仅供爱好者使用，现阶段免费使用，但对今后的授权模式不做任何保证。本软件与中国铁路总公司无关，不具有任何官方性质。
2. 开发人保留一切权利，包括但不限于：
   （1）随时修改软件内容而不事先告知任何人或者单位；
   （2）随时修改本说明而不事先告知任何人或者单位；
   （3）保护本软件版权不受侵害，并依法追究侵犯者责任；
   （4）对本说明及本软件一切内容的最终解释权。

特别感谢：“LGuo的电子运行图”软件（`ETRC`）。本软件最初的开发工作由此而起，并参考该软件较多功能。本软件支持读取和导出其运行图文件。

## 运行方式

运行方式：本软件可使用下列三种方式之任一运行。

1. 对于64位windows操作系统，可以使用【`win64`版本】，无需配置环境，直接参照包内提示运行即可。需注意【软件路径不得包含中文】。如果此方法无法运行，请考虑其他方法。
2. 对于任何操作系统，都可使用【`egg`版本】运行，需配置`Python 3.7`及`PyQt5`等环境，详见egg版发布包内的“运行说明.txt”文件。
3. 对于任何操作系统，都可使用【源代码】直接运行，需配置`Python 3.7`及`PyQt5`等环境，同时安装本项目支持库Timetable_new。源代码可在github上获取（https://github.com/CDK6182CHR/train_graph），Timetable_new库可在https://github.com/CDK6182CHR/Timetable_new 获取。详细运行说明参见github中本项目页面的说明。

对于有一定开发基础的使用者，如果希望快捷地获取本软件更新，建议使用源代码运行，使用git获取源代码和更新。

## 数据格式

本软件的数据文件都基于`json`（JavaScript Object Notation）格式，使用`UTF-8`编码格式（无签名，即`BOM`）。使用一般的读取`json`的工具即可读取本软件的数据文件。相关数据文件结构公开，欢迎用编程方法生成有关文件。

`2.3.0`版本之后，本软件的运行图文件后缀改为`*.pyetgr`，线路数据库文件后缀改为`*.pyetlib`，数据格式与原`*.json`格式一致，向前向后兼容。

## 依赖文件

本软件在`1.4.0`之后的版本中，无需程序相关文件之外的任何数据文件，即可正常启动。但涉及以下的数据文件，由本软件读取或者维护，如果缺失这些文件，可能造成数据丢失，或者部分功能不可用。以下内容以`2.3.0`版本为准。

* `system.json` 系统配置。此文件由系统第一次运行（关闭）时自动产生，用户无需主动维护。
* `config.json` 系统设置。此文件包含用户的系统默认设置信息。如果缺失或无效，则系统下一次运行时，会自动按照内置的方案进行配置。
* `lines.json` 旧版本的线路数据库。在`2.3.0`之前的版本，线路数据库维护（`ctrl+shift+H`）和导入线路（`ctrl+K`）两个功能依赖这个文件。在`2.3.0`及之后的版本中，此文件及这两个功能被标记过时，暂时保留可用性，但不再维护。如果缺失这个文件，导入线路（`ctrl+K`）功能无法使用。
* `sample.pyetgr` 内置的样例运行图文件。当上次的运行图文件找不到或者出错时，将打开本文件。在`2.3.0`之前的版本中，文件名为`sample.json`。缺失本文件不影响正常运行，但可能会在系统启动时打开空文件。
* `linesNew.pyetlib` `2.3.0`之后版本的新线路数据库。由新版本的线路数据库维护（`ctrl+H`）功能调用。如果缺失本文件，维护功能仍可用，但需要自行做数据。
* `station_map.json` 批量站名映射表。用以支持批量站名映射（`ctrl+shift+U`）功能。如果缺失，此功能仍然可用，但需要自行维护数据。

## 主要功能

1. 基本功能：绘制列车运行图，查看、编辑线路、车次信息。
2. 单独设置显示或隐藏某列车运行线，或者设置某一类列车运行线的显示/隐藏。
3. 单独设置某列车运行线的线形粗细、颜色，或者同时对某一类列车进行上述设置。
4. 查看、编辑线路运行标尺（时分标准）。从既有列车信息中读取标尺。
5. 按照标尺铺画新列车运行图，同时提供冲突检测功能。
6. 允许按标尺排图（即纵坐标是下行区间运行时分标准），允许存在上下行分设站。

更多功能不再一一列举，可分别试用软件菜单栏的工具。

********************************************************************
更新日志
---------------------------------------------------------------

### 2019年11月17日 发布2.3.2版本(R34)

更新日志（2.3.1->2.3.2）

1. 新增“运行图对比”功能，快捷键为`ctrl+6`。

### 2019年11月3日 发布2.3.1版本(R33)

更新日志（2.3.0->2.3.1）

1. 将线路编辑（`ctrl+X`）面板的里程栏支持到3位小数，同时新增注记功能（入口见右下角），允许为线路信息添加备注，其中的贡献者、版本信息将显示在“线路数据库”的表中。程序中部分地方涉及的里程仍为1位小数的配置，由于较多，不大可能一次性全部改正，将逐步更改，欢迎反馈。

2. 新增在“车次编辑”（`ctrl+C`）面板中，可以微调车次显示顺序（上移或者下移），并可以将顺序保存到运行图文件。

3. 新增“撤销所有推定”功能，可一键删除所有时刻表中备注为“推定”的时刻信息，可用于撤销使用“推定通过时刻”（`ctrl+2`）功能计算出的时刻。

4. 在“当前车次时刻表”（`ctrl+Y`）面板中新增是否只显示停车或者营业站的选项。

5. 在“调整当前车次时刻”（`ctrl+V`）功能中新增区间运行时长的显示，便于发现异常时刻。

6. 修复时刻推定时，不完整标尺引起异常的问题、当前车次编辑面板中，使用“前插”或者“后插”插入的行，更改时刻时没有实时更新停时等问题。

   



### 2019年10月16日 发布2.3.0版本(R32)

更新日志（2.2.7->2.3.0）

1. 【**重大调整**】重新设计“线路数据库维护”功能，快捷键为`ctrl+H`。新版本的线路数据库支持线路分类（分类可以任意多级别），管理界面支持增减线路、分类、导出分类、导出至当前运行图等功能。

   从原来的仅支持一个线路数据库文件（`lines.json`）改为支持任意多文件，且用户可自行选择文件打开。默认的文件是`linesNew.pyetlib`。旧版的`lines.json`文件仍然保留，且可以被新的线路数据库系统读取，但不再维护其中的数据；一般情况下，由新版线路数据库保存的数据库文件，即使重命名为`lines.json`，旧版的系统也不能正确读取。

   旧版的线路数据库维护（快捷键改为`ctrl+alt+H`）、导入线路（`ctrl+K`）功能继续保留，但被标记过时，不推荐使用。

   重新维护系统内置的线路数据库，增加了一些线路。

2. 调整扩展名系统。为了区分`pyETRC`所使用的的不同`.json`文件，减少误操作，自本版本开始，重新设计以下几类扩展名：

   * `*.pyetgr` 列车运行图文件；
   * `*.pyetlib` 线路数据库文件；
   * `*.pyetdb` 车次数据库文件。

   以上文件的结构与旧版的`*.json`文件没有区别，向前和向后均兼容。新版本的打开界面，默认仍然会显示`*.json`文件，以便打开旧版保存的文件。

### 2019年8月28日 发布2.2.7版本 (R31)

更新日志（2.2.6->2.2.7）

1. 【重要调整】重新设计“导入车次”功能（ctrl+D），并集成了原有的“导入实际运行线”（ctrl+shift+D）的功能。导入时允许选择某些特定车次导入，其中冲突车次用红色标出；可以选择是否覆盖冲突车次、冲突交路的处理方法、附加前缀。由于此功能很重要，为防止意外Bug影响使用，暂时保留了旧版的导入车次功能，快捷键调整为Ctrl+Alt+D。
2. 优化打开运行图时的行为，提高效率。
3. 新增天窗分方向显示功能。运行图中左上至右下划出的阴影线是下行天窗，反之是上行。交叉线，是不区分上下行的天窗，或者上下行天窗重合的区段。
4. 修复天窗铺画错误导致崩溃等Bug。

---------------------------------------------------------------
### 2019年7月19日 发布2.2.6版本

更新日志（2.2.5->2.2.6）

1. 新增标尺排图向导中“即时模式”的选项并默认启用。启用时，对时刻的修改将立即铺画在运行图上。
2. 优化“区间对数表”计算效率，提升大约两个数量级；优化铺画运行线，效率提升约20%；优化在运行图中选中车次的效率，提升大约30%。
3. 在运行图主窗口、当前车次面板中的时刻表、天窗编辑标尺排图向导的时刻表中新增简易的右键菜单支持。右键菜单提供既有功能的快捷操作方式，不是新功能。
4. 修复无车次时启动后不自动最大化等问题。

---------------------------------------------------------------
### 2019年7月9日 发布2.2.5版本

更新日志（2.2.4->2.2.5）

1. 【功能更新】新增交路图功能。仿照“中国动车组交路查询”的形式，允许将交路绘制成示意图。在交路编辑界面，进入编辑某一交路时，点击下方“交路图”进入。
2. 优化“交互式时刻表”打开时选中车次时的响应速度，优化在图中选中车次时系统的响应速度。
3. 修正相同起始时刻导致误判为未占用股道等问题。

---------------------------------------------------------------
### 2019年7月5日 发布2.2.4版本

更新日志（2.2.3->2.2.4）

1. 【功能更新】新增区间换线功能，快捷键为ctrl+5。允许交换当前选中车次和另一车次在某一指定区间的运行时刻（即运行线）。可指定是否包含起始站的到达时间和终止站的出发时间。
2. 【功能更新】新增当前车次区间运行线重排功能，快捷键为ctrl+shift+R。选定当前车次的某一区间，调用“标尺排图向导”重新铺画该区间运行线，用新铺画的车次运行线取代指定区间的运行线，同时删除新铺画的车次。当区间始点在本线时，系统自动选中起始站并进入第二步，并自动填好起始站和终止站的已知时刻。用户也可以手动点击“上一步”重新选择。
3. 在“标尺排图向导”功能中，新增允许在排图时临时调整区间标尺，例如慢行附加。调整栏以秒作为单位，可以是负值或者是正值。请注意，如果使得区间标尺的最终值为负值，会引发预料之外的结果。
4. 【功能更新】新增“交互式时刻表”停靠面板，快捷键为ctrl+shift+Y。面板布局与当前车次时刻表类似，但通过此面板可以直接修改当前车次的时刻表，修改立即生效，当修改站属于本线时，还会立即重新铺画运行线。请注意，此功能带来潜在的效率问题和误触风险，建议在不使用时隐藏此面板。
5. 修复当前车次提交更改时没有重置y值查找表，修改站名时天窗编辑面板没有更新，表格中新增未编辑的空行导致程序崩溃等Bug。

---------------------------------------------------------------
### 2019年6月30日 发布2.2.3版本

更新日志（2.2.2->2.2.3）

1. 【重要功能更新】新增显示交路连接线功能。对于用户勾选“连线”选项，且前序车次和本车次在本线同一车站终到始发的情况，系统自动以虚线连接车次运行线。
2. 【重要特性更新】在“车站时刻可视化”（ctrl+E，选择车站后点下方“可视化”进入本功能）功能中，新增识别交路衔接时股道占用的逻辑。对于符合上一条要求的连接情况，将前序车次终到至后续车次始发的一段时间判定为占用一条股道。以上两条是开发交路功能的初衷。
3. 在“区间车次表”（ctrl+shift+3）中新增允许筛选是否营业、是否停车的功能。其中停车包含始发终到。默认情况仅显示营业车次。
4. 重新设计“当前车次时刻表”（ctrl+Y）面板的显示格式。在“车次信息”面板中新增前序后序。
5. 修复“重新读取运行图”时没有删除原运行图信息等bug。

---------------------------------------------------------------
### 2019年6月25日 发布2.2.2版本

更新日志（2.2.1->2.2.2）

1. 【重要功能更新】将“车次信息”功能升级成停靠面板，快捷键仍为ctrl+Q。此面板包含车次的主要信息（除时刻表外），并设计了指向时刻表和编辑界面的按钮，设计初衷是使用时长期停靠此面板。
2. 【重要功能更新】新增“车次时刻表”功能，快捷键为ctrl+Y。显示当前选中车次的时刻表，时刻表是只读的。其中站名为红色表示在该站营业，为蓝色表示在该站停车但不营业，与“当前车次设置”中规定相同。设计初衷是解决“当前车次设置”中查看时刻表不方便（能看到的太少）且容易误操作的问题。
3. 【功能更新】将“简明功能表”集成到软件中，快捷键为F1，可快速查看本软件功能。
4. 【功能更新】为“车底交路”新增“担当局段”和“车底类型”两项属性，同时作为车次的只读虚拟属性。两项属性可设置为任意的字符串。在“车站时刻表”（ctrl+E）中新增显示车底和担当局段，在“车次信息”（ctrl+Q）中新增显示车底和担当，在“车次筛选器”中新增按车底和担当筛选车次的功能。同时在“车站时刻表”中新增对车次筛选器的支持。
5. 新增软件启动和打开新运行图文件时检查运行图文件是否符合当前软件版本的要求，特别是2.1版本中预制正则表达式错误遗留下来的问题。
6. 修复“车站时刻可视化”中0点附近通过列车绘制错误、天窗编辑面板无法刷新及取消勾选“上下行分设”引起崩溃、当前车次信息中设置的“备注”没有保存等bug。

---------------------------------------------------------------
### 2019年6月2日 发布2.2.1版本

更新日志（2.1.1->2.2.0）
【2.1版本累积更新】

1. 新增对ETRC天窗数据读写的支持。
2. 新增“当前车次设置”停靠面板时刻表中，按照是否停车及是否营业区分站名颜色。通过为黑色，营业为红色，停车不营业为蓝色。同时支持“停时”一列实时变化。
【2.2版本重要更新】
3. 基础数据中新增“车底交路”。编辑面板在（窗口->交路编辑，ctrl+4）。支持编写和维护车底交路，可以高亮车底交路中的所有车次。
4. 在“车次筛选器”中新增允许按所属交路筛选车次的逻辑。
5. 修复“当前车次事件表”功能中，上行车次出现大面积到发时刻排反的问题。
6. 调整架构。源代码示例文件sample.json替换为达成单线2019年1月25日运行图数据，在源代码管理中删除标准的config.json和system.json文件，这两个文件将由系统在有需要时自动创建。

更新日志（2.2.0->2.2.1）
1. 新增对ETRC交路数据读写的支持。
2. 为“导出ETRC运行图文件”功能分配快捷键ctrl+M。

---------------------------------------------------------------
### 2019年5月12日 发布2.1.1版本

更新日志（2.1.0->2.1.1）

1. 修复2.1.0版本公布以来已经发现的一些bug。具体为：车次类型预置的正则表达式有错误的问题（新版本中同时新增了对正则表达式的校验）；点击“当前车次时刻表重排”时程序崩溃的问题；对空运行图使用“运行图信息”导致程序崩溃的问题；“车次编辑”中排序错误的问题。以上问题对正常使用有比较大的影响，请及时将2.1.0版本升级到此版本。
2. 在“区间对数表”功能中新增筛选办客/办货车站的功能，同时提高计算速度。

---------------------------------------------------------------
### 2019年5月7日 发布2.1.0版本

更新日志（2.0.1->2.1.0）
说明：由于历史原因，文档和源代码中若提到2.0.2版本，也是指这个版本。

1. 【**重大逻辑修改**】调整列车类型定义系统。建立从列车车次形式（正则表达式给出）->列车种类->是否为旅客列车的严格映射关系，用户可自行修改列车种类的规定，见“运行图设置（ctrl+G）”和“系统默认设置（ctrl+shift+G）”面板。同时，严格定义列车种类系统，在“当前车次设置”（ctrl+I）面板中新增“旅客列车”选项；在“显示类型设置（ctrl+L）”面板、“车次筛选器”（全局情况下使用ctrl+shift+L调出，其他情况有相应按钮）中新增筛选是否是客车的条件。
2. 【功能更新】新增“当前车次时刻表重排”功能，提供对单个车次时刻表顺序调整、交换到发站的操作，在菜单栏和“当前车次设置”（ctrl+I）面板可以调出，也可以使用快捷键ctrl+V。
3. 【功能和逻辑更新】新增对时刻表中车站是否办理业务的区分。在线路编辑面板（ctrl+X）中，每个站均有“办客”和“办货”两项参数，如果勾选表示在此站停车的客车（货车）默认情况下办理业务（即营业），否则默认情况下不营业。在“当前车次设置”（ctrl+I）面板中，时刻表的每一行新增“营业”选项，勾选表示在此站办理业务（客车是办客，货车是办货）。默认情况下，始发终到站办理业务；中间有停点且该站（在线路编辑表中）勾选了对应（客车或货车）办理业务的情况下，时刻表中该站办理业务；否则不办理。此设置也可以手工设置，且可以任意设置，甚至可以将不停车的站设为办客站。“区间对数表”（ctrl+3）和“区间车次表”（ctrl+shift+3）功能中筛选列车的条件由两站皆停车改为两站皆办理业务。
4. 在菜单栏“工具”菜单下新增：重置所有列车营业站、自动设置是否客车功能。这两个功能皆是把系统默认的设置适配到列车上，即在列车的数据中不再保留“自动”的选项。此功能不可撤销，请慎用。新增“自动适配始发终到站”功能，将符合一定条件的始发终到站修改为对应时刻表的第一站和最后一站（条件比较严格），详见弹出窗口。
5. 新增放大缩小运行图功能。快捷键为ctrl+=和ctrl+-（即：主键盘上的+-键），分别将当前运行图显示比例设为原来的125%和80%。
6. 重新理顺图元叠加关系，使得天窗阴影层位于底图框线和运行线之间，也就是说天窗阴影区域仍可以选中列车运行线。修复标尺排图向导中，点击“上一步”导致程序崩溃的问题。
7. 新增导入运行线时可选择是覆盖还是忽略重复列车；在运行图上增加版本标记，若尝试打开更高版本的运行图，会显示警告信息。

---------------------------------------------------------------
### 2019年3月27日 发布2.0.1版本

更新日志（2.0.0->2.0.1）

1. 修复2.0.0版本中一个特定情况下程序崩溃的bug。
2. 将“车次编辑”面板中的“跨越站数”列修改为“本线旅速”，同时理顺本线运行时间、运行里程的计算，皆依赖于运行线铺画设置（2.0新版特性），修复相关bug。同时，即使在手动管理运行线模式下，铺画运行图时也会自动根据实际的运行线起止站修改运行线管理数据。
3. 线路数据库修改。删除部分无意义的线路划分，将里程精确到小数的线路数据后缀“F”以示区分，同时新增部分线路数据。此版本线路数据库有97条数据。

---------------------------------------------------------------
### 2019年3月24日 发布2.0.0版本

更新日志（1.5.2->2.0.0）

1. 新增自动区分始发和邻线驶来，终到和驶向邻线的起止点标签样式。区分的逻辑是检测运行线上第一个站是否可以（在支持域解析符的前提下）匹配到始发站。
2. 【重大逻辑更新】新增运行线管理逻辑，允许一趟列车（i.e.“车次编辑”中的一行）拥有多条运行线。允许自动管理和手动管理。
自动管理时有跨越站数和行别变化两种逻辑。对于跨越站数逻辑，当列车某两个【可以铺画在运行图上的站点之间】的非本线站超过设定阈值（在“运行图设置”面板，ctrl+G中设置阈值，默认是3）时，即判定本次列车在本区间不经由本线运行，将运行线在此断开，分成两段运行线；对于行别变化逻辑，当铺画运行线时检测到上下行情况发生变化时，将运行线在此断开，分为两段。两段运行线之间不安排起止标签。
手动管理时可以任意设置运行线的分隔，以及每一段运行线的上下行、是否显示起止标签。手动管理的入口见“当前车次设置”面板（ctrl+I）。请注意面板中同时有“自动管理”选项，手动设置的内容仅当“自动管理”被取消勾选是才有效，否则设置无效，且会被自动管理的信息覆盖。
（以下两条也是2.0.0 Preview3->正式版的更新内容）
3. 在线路拼接（ctrl+J）时自动合并标尺数据。
4. 在标尺编辑面板（ctrl+B）中新增合并标尺功能，可以将另一标尺与当前标尺合并，对于交叉区间可以选择是覆盖还是忽略。
5. 调整“标尺对照”（ctrl+W）功能的逻辑，改为将本次列车所有在本线路上的区间都列出（而不管上下行问题）。此调整对于在本线上有调向的车次的效果有所提升。
6. 调整“标尺排图向导”（ctrl+R）中“追加到车次”时的规则。追加到既有车次时，不再限制行别只能与原车次一致，而允许调向。对于原时刻表中相同车站是否覆盖的问题，取决于排图起始点处原车次的行别与当前排图行别的关系（相同时覆盖，不同时不覆盖而追加）。同时，强烈建议在使用本功能时先删除原车次的非本线站。
7. 更新“核心功能简介与技巧提示”PDF文件，对新版逻辑做了详细说明，建议阅读。
8. 线路数据库中更新濉阜线、萧甬线等数据，线路数据库扩充至96条。

---------------------------------------------------------------
### 2019年3月23日 发布2.0.0 Preview3版本

更新日志（1.5.2->2.0.0 Preview3）
【请注意Preview版本会存在比较多的问题，尤其是与上下行相关的部分。请及时保存数据，欢迎反馈问题！】

1. 新增自动区分始发和邻线驶来，终到和驶向邻线的起止点标签样式。区分的逻辑是检测运行线上第一个站是否可以（在支持域解析符的前提下）匹配到始发站。
2. 【重大逻辑更新】新增运行线管理逻辑，允许一趟列车（i.e.“车次编辑”中的一行）拥有多条运行线。允许自动管理和手动管理。
自动管理时有跨越站数和行别变化两种逻辑。对于跨越站数逻辑，当列车某两个【可以铺画在运行图上的站点之间】的非本线站超过设定阈值（在“运行图设置”面板，ctrl+G中设置阈值，默认是3）时，即判定本次列车在本区间不经由本线运行，将运行线在此断开，分成两段运行线；对于行别变化逻辑，当铺画运行线时检测到上下行情况发生变化时，将运行线在此断开，分为两段。两段运行线之间不安排起止标签。
手动管理时可以任意设置运行线的分隔，以及每一段运行线的上下行、是否显示起止标签。手动管理的入口见“当前车次设置”面板（ctrl+I）。请注意面板中同时有“自动管理”选项，手动设置的内容仅当“自动管理”被取消勾选是才有效，否则设置无效，且会被自动管理的信息覆盖。

---------------------------------------------------------------
### 2019年3月19日 发布1.5.2版本

更新日志（1.5.1->1.5.2）

1. 新增对触摸屏系统中划屏滚动的支持。
2. 新增在导入线路时允许选择任意一部分站点来导入。
3. 新增缩放运行图功能，快捷键为ctrl+=（放大）和ctrl+-。
4. 修复特定情况下打开新运行图时程序崩溃的问题（仅限编译版本）、特定情况下“两车次运行对照”功能不能正常显示数据的问题。
5. 更新新长线、阜淮线、淮南线等线路的基本数据，线路数据库扩充至92条数据。

---------------------------------------------------------------
### 2019年3月7日 发布1.5.1版本

更新日志（1.5.0->1.5.1）

1. 【重大功能更新】新增在运行图上显示停站时刻的支持，见“运行图设置”面板及“系统默认设置”面板。允许设置三种模式，即不显示、仅显示选中车次的停点（默认）、显示所有车次的停点。图中显示的是精确到分钟的时刻尾数（秒数小于30秒的舍去，否则进位。无论运行图格线间距为多少，总是只显示一位数字）。
注意：
（1）明显的效率问题：若设置为显示所有车次的停点，会明显延长运行图铺画时间。以“京沪线徐沪段”测试用例为例，运行图铺画时间延长约40%。
（2）现阶段标记的方向由车次的“逻辑上下行”决定。当车次在本线内的上下行判断（或输入）错误或者在本线内发生调向时，标记方向会出错。
2. 在导出的运行图中新增版本标记。

---------------------------------------------------------------
### 2019年3月1日 发布1.5.0版本

更新日志（1.4.2->1.5.0）

1. 【重要功能更新】新增对导出Pdf格式矢量运行图的支持，快捷键为ctrl+shift+T。
2. 修复“显示类型设置”中点击“显示上行（下行）”按钮导致非显示类型的车次运行线被显示的问题；修复特定情况下“标尺对照”（ctrl+W）功能导致程序崩溃的问题。

---------------------------------------------------------------
### 2019年2月27日 发布1.4.2版本

更新日志（1.4.1->1.4.2）

1. 新增“车次编辑”面板中点击“新增”后光标自动移动到“当前车次设置”窗口逻辑；新增“导入站表”功能上行列车将站表反序排列。
2. 修复“当前车次事件表”中低概率将站内事件判断为区间事件引起程序崩溃的问题；修复车次编辑表中双击车次行导致程序崩溃的问题；修复初始化过程中产生的三个警告。
3. 新增车次事件表、车站时刻表中显示列车时刻表中的“备注”功能。；“标尺排图向导”中新增Alt+C查看冲突车次时，将相差10分钟以内的可能冲突车次用红色字体显示。
4. 车次筛选器中新增按始发终到站筛选及反选功能。
5. 车次编辑（ctrl+C）面板新增批量修改车次运行线颜色宽度功能。
5. 更新本系统自带线路数据库，目前数据库中有83条记录。

---------------------------------------------------------------
### 2019年2月21日 发布1.4.1版本

更新日志（1.4.0->1.4.1）

1. 修复1.4.0版本中使用车次切片功能（ctrl+Z）引起程序崩溃的bug。
2. 将运行图设置（ctrl+G）面板中的“底图设置”改为“详细尺寸设置”，同时在其中新增对起点终点标签高度、（大部分的）表格行高的控制，以方便在显示比例较小（100%，125%）而分辨率较大的电脑上提高空间利用率。
3. 新增当窗口大小变化时，自动移动距离轴、时间轴到屏幕边缘悬浮。
4. 新增简明功能表说明文档。

---------------------------------------------------------------
### 2019年2月17日 发布1.4.0版本

更新日志（1.3.4->1.4.0）

1. 修改底层系统设置有关内容的逻辑架构，重新理顺有关操作，减少程序崩溃和出现bug的机会。同时增加配置文件system.json。
2. 当配置文件config.json或system.json出现问题时，不再报错，而是使用系统内置的一套数据自动重置。
3. 彻底分离运行图设置和系统默认设置两项内容，新增“系统默认设置”面板（ctrl+shift+G调出）；同时将“默认颜色设置”面板合入“系统默认设置”和“运行图设置”两个面板中，取消快捷键ctrl+Y。
4. 新增启动本软件时，自动打开上一次关闭时打开的停靠面板。
5. 自本版本开始新增.egg文件运行方式。

---------------------------------------------------------------
### 2019年1月29日 发布1.3.4版本

更新日志（1.3.3->1.3.4）

1. 【重要新特性】新增运行线“有效选择宽度”功能，见“运行图设置”面板（ctrl+G）。允许在运行线周围设定倍数宽度的范围内，点击都能选中运行线。当设定值大于1时启用。请注意此功能会增加运行图铺画耗时。
2. 【新功能】新增“两车次时分对照”功能，可对比两个选定车次在本线各区间的运行时间数据。见查看->两车次时分对照，或使用快捷键ctrl+shift+W。
3. 【新特性】新增选中运行线时，将鼠标放在运行线区间或停站位置上，显示区间或停站的运行数据。
4. 新增铺画运行图中将“::”符号替换为“*”（仅作用于运行图上，不影响设置）；修复部分已知bug。

---------------------------------------------------------------
### 2019年1月29日 发布1.3.3版本（2019新春版）

更新日志（1.3.2->1.3.3）

1. 【重大功能更新】在运行图左侧坐标轴处新增“延长公里”和“排图标尺”两列，显示车站的延长公里数和排图所用标尺的各个区间时分。若是按里程排图，则延长公里栏留空。
2. 【功能更新】在车次面板增加“筛选”功能，允许筛选符合特定条件的车次展示。同时，车次筛选器新增“清除筛选”功能，一键清空所有选择。
3. 【效率优化】优化特定场景的程序运行效率。在默认运行图“京沪线徐沪段”条件下测试，启动时间减少1/3（数据仅供参考）。
4. 修复上一版本中在线路编辑面板点击确定没有效果等已知bug。

---------------------------------------------------------------
### 2019年1月29日 发布1.3.2版本

更新日志（1.2.5->1.3.2）

1. 【重大功能更新】新增“区间对数表”功能，支持以某个车站为中心，显示发/到本线其他所有车站的车次对数。列车被计入对数，当且仅当列车被筛选器选中，并在发站、到站都停车。功能位于查看->区间对数表，快捷键为ctrl+3.
2. 【重大功能更新】新增“区间车次表”功能，支持查询任何两站（不限于本线）之间的车次。车次被列入的条件同上一条。本功能类似时刻表软件的查询两站之间车次功能。位于查看->区间车次表，快捷键为ctrl+shift+3。
3. 【重大功能更新】新增“列车筛选器”功能，可在前两条所述功能中用于筛选车次，也可在全局筛选。支持以类型，是否显示等筛选车次，也可以按“正则表达式”添加或者排除某一类车次。全局操作位于查看->高级显示车次设置，快捷键为ctrl+shift+L。
4. 在车次列表中新增显示车次跨越车站数的功能，可用于筛选并不实际通过本线的车次。
5. 运行图字体调整及其他较小更新；部分BUG修复，不再一一列举。
6. 数据更新：新提供部分运行图文件，更新线路数据库文件。

---------------------------------------------------------------
### 2018年11月24日 发布1.2.5版本

更新日志（1.2.3->1.2.5）

1. 【重大功能更新】新增“推定通过站时刻”功能（调整->推定通过时刻），快捷键为ctrl+2。支持在只给出（所有）停车站时刻的情况下，按标尺比例分配区间运行时分，给出区间通过站的时刻。时刻精确到秒。
2. 【功能更新】新增车次区间性质计算功能（查看->当前车次区间性质计算, ctrl+shift+W），给出当前车次在某个区间的停车次数，均速等信息。计算的区间不包括起始站和终止站的停车（类似于购票信息，买票人通常并不关心上车站的到达时间而只关心其出发时间）。
3. 【功能更新】新增列车时刻表中每个站的备注功能。对于上一条功能中推定车站的时刻默认备注“推定”，可以自行修改。
4. 修复调整站名时始发终到站没有随之调整的问题。修复特定情况下“列车事件时刻表”计崩溃的问题。新增“列车事件时刻表”计算过程的进度条（避免被操作系统判定为无响应）。修复特定场景下通过某些方式选中列车运行线，系统无响应的问题。

---------------------------------------------------------------
### 2018年9月21日 发布1.2.3版本

更新日志（1.2.2->1.2.3）

1. 【重大功能更新】新增“天窗编辑”停靠面板（调出方式是窗口->天窗编辑，ctrl+1（数字））。支持编辑线路的天窗信息并随线路信息存储；同时在线路数据库处理中增加该功能入口。支持分上下行编辑和显示天窗，显示时天窗时间以半透明浅灰色显示在运行图中；天窗的设置并不影响运行图铺画，是否与天窗冲突需要人工检查。
2. 修复“当前车次设置”停靠面板中调整车次是否显示信息无效、“车次编辑”停靠面板中删除车次导致系统崩溃、“标尺对照”功能中小于1分钟的负值负号丢失的问题。
3. 铺画运行图时改为每铺画10个车次才更新一次界面，大幅提高大运行图的铺画效率。
---------------------------------------------------------------
### 2018年8月27日 发布1.2.2版本
更新日志（1.2.1->1.2.2）

1. 在“车站时刻表输出”中“可视化”模块增加“高级”设置（查看->车站时刻表输出->可视化->高级）。支持单双线铺画模式选择、是否允许正线停车、设置同向和对向接车间隔。
2. 在“标尺排图向导”支持追加到车次排图的基础上，允许选择“附加位置”，即选择原时刻表中不存在的车站置于时刻表首还是尾的选项。
3. 更新技巧提示。

更新日志（1.2.0->1.2.1）
1. 在“运行图设置”停靠面板（窗口->运行图设置, ctrl+G）面板中新增“运行图说明或备注”，可以填写任意的文本内容。
2. 在“车站时刻表输出”中“可视化”模块增加调整水平缩放比例的功能。

---------------------------------------------------------------
### 2018年8月24日 发布1.2.0版本
更新日志（1.1.2->1.2.0）

1. 修复标尺不符合排图条件时，没有报错的Bug。
2. 在“线路数据库维护”（ctrl+H，数据->线路数据库维护）功能中，修复若修改标尺数据并点击确定则会引起新增一个“新建”Tab的Bug；新增保存时按拼音排序功能。
3. 新增“刷新”功能，其功能是重新铺画当前运行图并更新所有停靠面板数据。在文件->刷新，快捷键为F5。
4. 在“车次编辑”面板（窗口->车次编辑，ctrl+C）中，新增列字段“本线里程”，描述列车在本线运行的里程数据。可对此排序。
5. 在“车站时刻表输出”（查看->车站时刻表输出，ctrl+E）中新增对列字段排序功能；同时修复“当前车次事件表”（查看->当前车次事件表，ctrl+Z）中列字段排序按字符串排序（而不是数字）的bug。
6. 修复“默认颜色设置”面板（窗口->默认颜色设置，ctrl+Y）中，保存到系统设置实际没有执行的bug。（点击确定后弹出对话框选择Yes）
7. 在“当前车次标尺对照”（查看->当前车次标尺对照, ctrl+W）中，新增对域解析符的支持。
8. 新增从Excel表格读取线路信息功能。位置：数据->导入线路信息(Excel)，快捷键为ctrl+shift+K
9. 线路数据库更新。

---------------------------------------------------------------
### 2018年8月22日 发布1.1.2版本
更新日志（1.1.1->1.1.2）

1. 【重大功能更新】在“车站时刻表输出”（查看->车站时刻表输出，ctrl+E）中新增车站时刻表可视化功能，按双线排图给出一种股道占用方案。在前述面板中点击下方中间的“可视化”进入。
2. 在“车站时刻表输出”（查看->车站时刻表输出，ctrl+E）中支持站名域解析符限定，并新增“站名”列，列出的是车次时刻表中的站名。（例如，设“宝成线广成段”运行图中，K2615次列车时刻表中存在“广元西::85#”，线路站名表中只有“广元西”，则使用此功能输出“广元西”车站时刻表时，“广元西::85#”匹配到“广元西”站，其“站名”列的内容是“广元西::85#”。）
3. 在车次编辑停靠面板（窗口->车次编辑，ctrl+C）发起批量“删除”车次操作时，显示进度条并实时更新界面，防止被操作系统判定为无响应。
4. 在铺画运行图时（除程序启动铺画第一个运行图），显示列车运行线铺画的进度条并实时更新界面，防止被操作系统判定为无响应。
5. 在“标尺编辑”停靠面板（窗口->标尺编辑, ctrl+B）点击“确定”或修改某行数据后，若该行实际无数据（区间运行时分是0分0秒）则将该行标红提示。

---------------------------------------------------------------
### 2018年8月21日 发布1.1.1版本
更新日志（1.1.0->1.1.1）

1. 在“标尺排图向导”（工具->标尺排图向导, ctrl+R）面板中新增“追加到车次”排图功能。此功能允许在既有的车次基础上排图，所排的站点时刻表覆盖原有同名站点，而其他站点时刻表不受影响。请注意，此功能目前只支持追加排图，不支持倒推排图。
2. 在使用“运行图拼接”功能（工具->运行图拼接，ctrl+J）时，新增逻辑：对需要连接的车次，先删除该车次不在本线及需要连接线路中的站点时刻，再进行连接。可解决特定情况下连接运行图导致时刻表错误，运行图混乱的情况。
3. 修复“线路数据库维护”（数据->线路数据库维护，ctrl+H）中使用“导入”功能后，在退出数据库之前，导入的数据修改无效的Bug。
4. 修复“标尺排图向导”使用过程中执行引起重新排图的操作后，系统崩溃的Bug。

---------------------------------------------------------------
### 2018年8月20日 发布1.1.0版本
更新日志（1.0.9->1.1.0）

1. 修复标尺编辑面板（ctrl+B）中，执行“删除标尺”命令后，标尺实际并未被删除的bug。
2. 新增显示风格插件，解决之前发布版本中，软件界面风格为Windows 98风格的问题。

---------------------------------------------------------------
### 2018年8月19日 发布1.0.9版本
更新日志（1.0.8->1.0.9）

1. 新增批量复制当前车次运行线功能（调整->批量复制当前运行线, ctrl+shift+A）。
2. 新增模糊检索车次功能（工具->模糊检索车次，ctrl+shift+F）。
3. 在“线路数据库维护”功能（数据->线路数据库维护, ctrl+H）中新增搜索线路站名的支持，允许搜索线路中的站名，支持域解析符下的模糊检索（即：搜索“成都东”可匹配到“成都东::达成场”）。

---------------------------------------------------------------
### 2018年8月18日 发布1.0.8版本
更新日志（1.0.7->1.0.8）

1. 修复“标尺排图向导”功能中点击“上一步”按钮无效的问题。
2. 调整标尺排图向导完成逻辑。点击确定时设置车次，由系统自动推断类型，同时将新铺画的列车提交到列车表中。

---------------------------------------------------------------
### 2018年8月17日 发布1.0.7版本

第一个发行版本，实现基本功能。

